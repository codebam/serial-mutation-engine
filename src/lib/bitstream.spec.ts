import { describe, it, expect } from 'vitest';
import { Bitstream } from './bitstream';

// Go output data (truncated for brevity, will be filled with actual data)
const goOutput = `
varint,0,00
varbit,0,00
varint,1,80
varbit,1,84
varint,2,40
varbit,2,42
varint,3,c0
varbit,3,46
varint,4,20
varbit,4,c1
varint,5,a0
varbit,5,c5
varint,6,60
varbit,6,c3
varint,7,e0
varbit,7,c7
varint,8,10
varbit,8,2080
varint,9,90
varbit,9,2480
varint,10,50
varbit,10,2280
varint,11,d0
varbit,11,2680
varint,12,30
varbit,12,2180
varint,13,b0
varbit,13,2580
varint,14,70
varbit,14,2380
varint,15,f0
varbit,15,2780
varint,16,0c00
varbit,16,a040
varint,17,8c00
varbit,17,a440
varint,18,4c00
varbit,18,a240
varint,19,cc00
varbit,19,a640
varint,20,2c00
varbit,20,a140
varint,21,ac00
varbit,21,a540
varint,22,6c00
varbit,22,a340
varint,23,ec00
varbit,23,a740
varint,24,1c00
varbit,24,a0c0
varint,25,9c00
varbit,25,a4c0
varint,26,5c00
varbit,26,a2c0
varint,27,dc00
varbit,27,a6c0
varint,28,3c00
varbit,28,a1c0
varint,29,bc00
varbit,29,a5c0
varint,30,7c00
varbit,30,a3c0
varint,31,fc00
varbit,31,a7c0
varint,32,0a00
varbit,32,6020
varint,33,8a00
varbit,33,6420
varint,34,4a00
varbit,34,6220
varint,35,ca00
varbit,35,6620
varint,36,2a00
varbit,36,6120
varint,37,aa00
varbit,37,6520
varint,38,6a00
varbit,38,6320
varint,39,ea00
varbit,39,6720
varint,40,1a00
varbit,40,60a0
varint,41,9a00
varbit,41,64a0
varint,42,5a00
varbit,42,62a0
varint,43,da00
varbit,43,66a0
varint,44,3a00
varbit,44,61a0
varint,45,ba00
varbit,45,65a0
varint,46,7a00
varbit,46,63a0
varint,47,fa00
varbit,47,67a0
varint,48,0e00
varbit,48,6060
varint,49,8e00
varbit,49,6460
varint,50,4e00
varbit,50,6260
varint,51,ce00
varbit,51,6660
varint,52,2e00
varbit,52,6160
varint,53,ae00
varbit,53,6560
varint,54,6e00
varbit,54,6360
varint,55,ee00
varbit,55,6760
varint,56,1e00
varbit,56,60e0
varint,57,9e00
varbit,57,64e0
varint,58,5e00
varbit,58,62e0
varint,59,de00
varbit,59,66e0
varint,60,3e00
varbit,60,61e0
varint,61,be00
varbit,61,65e0
varint,62,7e00
varbit,62,63e0
varint,63,fe00
varbit,63,67e0
varint,64,0900
varbit,64,e010
varint,65,8900
varbit,65,e410
varint,66,4900
varbit,66,e210
varint,67,c900
varbit,67,e610
varint,68,2900
varbit,68,e110
varint,69,a900
varbit,69,e510
varint,70,6900
varbit,70,e310
varint,71,e900
varbit,71,e710
varint,72,1900
varbit,72,e090
varint,73,9900
varbit,73,e490
varint,74,5900
varbit,74,e290
varint,75,d900
varbit,75,e690
varint,76,3900
varbit,76,e190
varint,77,b900
varbit,77,e590
varint,78,7900
varbit,78,e390
varint,79,f900
varbit,79,e790
varint,80,0d00
varbit,80,e050
varint,81,8d00
varbit,81,e450
varint,82,4d00
varbit,82,e250
varint,83,cd00
varbit,83,e650
varint,84,2d00
varbit,84,e150
varint,85,ad00
varbit,85,e550
varint,86,6d00
varbit,86,e350
varint,87,ed00
varbit,87,e750
varint,88,1d00
varbit,88,e0d0
varint,89,9d00
varbit,89,e4d0
varint,90,5d00
varbit,90,e2d0
varint,91,dd00
varbit,91,e6d0
varint,92,3d00
varbit,92,e1d0
varint,93,bd00
varbit,93,e5d0
varint,94,7d00
varbit,94,e3d0
varint,95,fd00
varbit,95,e7d0
varint,96,0b00
varbit,96,e030
varint,97,8b00
varbit,97,e430
varint,98,4b00
varbit,98,e230
varint,99,cb00
varbit,99,e630
varint,100,2b00
varbit,100,e130
varint,101,ab00
varbit,101,e530
varint,102,6b00
varbit,102,e330
varint,103,eb00
varbit,103,e730
varint,104,1b00
varbit,104,e0b0
varint,105,9b00
varbit,105,e4b0
varint,106,5b00
varbit,106,e2b0
varint,107,db00
varbit,107,e6b0
varint,108,3b00
varbit,108,e1b0
varint,109,bb00
varbit,109,e5b0
varint,110,7b00
varbit,110,e3b0
varint,111,fb00
varbit,111,e7b0
varint,112,0f00
varbit,112,e070
varint,113,8f00
varbit,113,e470
varint,114,4f00
varbit,114,e270
varint,115,cf00
varbit,115,e670
varint,116,2f00
varbit,116,e170
varint,117,af00
varbit,117,e570
varint,118,6f00
varbit,118,e370
varint,119,ef00
varbit,119,e770
varint,120,1f00
varbit,120,e0f0
varint,121,9f00
varbit,121,e4f0
varint,122,5f00
varbit,122,e2f0
varint,123,df00
varbit,123,e6f0
varint,124,3f00
varbit,124,e1f0
varint,125,bf00
varbit,125,e5f0
varint,126,7f00
varbit,126,e3f0
varint,127,ff00
varbit,127,e7f0
varint,128,0880
varbit,128,1008
varint,129,8880
varbit,129,1408
varint,130,4880
varbit,130,1208
varint,131,c880
varbit,131,1608
varint,132,2880
varbit,132,1108
varint,133,a880
varbit,133,1508
varint,134,6880
varbit,134,1308
varint,135,e880
varbit,135,1708
varint,136,1880
varbit,136,1088
varint,137,9880
varbit,137,1488
varint,138,5880
varbit,138,1288
varint,139,d880
varbit,139,1688
varint,140,3880
varbit,140,1188
varint,141,b880
varbit,141,1588
varint,142,7880
varbit,142,1388
varint,143,f880
varbit,143,1788
varint,144,0c80
varbit,144,1048
varint,145,8c80
varbit,145,1448
varint,146,4c80
varbit,146,1248
varint,147,cc80
varbit,147,1648
varint,148,2c80
varbit,148,1148
varint,149,ac80
varbit,149,1548
varint,150,6c80
varbit,150,1348
varint,151,ec80
varbit,151,1748
varint,152,1c80
varbit,152,10c8
varint,153,9c80
varbit,153,14c8
varint,154,5c80
varbit,154,12c8
varint,155,dc80
varbit,155,16c8
varint,156,3c80
varbit,156,11c8
varint,157,bc80
varbit,157,15c8
varint,158,7c80
varbit,158,13c8
varint,159,fc80
varbit,159,17c8
varint,160,0a80
varbit,160,1028
varint,161,8a80
varbit,161,1428
varint,162,4a80
varbit,162,1228
varint,163,ca80
varbit,163,1628
varint,164,2a80
varbit,164,1128
varint,165,aa80
varbit,165,1528
varint,166,6a80
varbit,166,1328
varint,167,ea80
varbit,167,1728
varint,168,1a80
varbit,168,10a8
varint,169,9a80
varbit,169,14a8
varint,170,5a80
varbit,170,12a8
varint,171,da80
varbit,171,16a8
varint,172,3a80
varbit,172,11a8
varint,173,ba80
varbit,173,15a8
varint,174,7a80
varbit,174,13a8
varint,175,fa80
varbit,175,17a8
varint,176,0e80
varbit,176,1068
varint,177,8e80
varbit,177,1468
varint,178,4e80
varbit,178,1268
varint,179,ce80
varbit,179,1668
varint,180,2e80
varbit,180,1168
varint,181,ae80
varbit,181,1568
varint,182,6e80
varbit,182,1368
varint,183,ee80
varbit,183,1768
varint,184,1e80
varbit,184,10e8
varint,185,9e80
varbit,185,14e8
varint,186,5e80
varbit,186,12e8
varint,187,de80
varbit,187,16e8
varint,188,3e80
varbit,188,11e8
varint,189,be80
varbit,189,15e8
varint,190,7e80
varbit,190,13e8
varint,191,fe80
varbit,191,17e8
varint,192,0980
varbit,192,1018
varint,193,8980
varbit,193,1418
varint,194,4980
varbit,194,1218
varint,195,c980
varbit,195,1618
varint,196,2980
varbit,196,1118
varint,197,a980
varbit,197,1518
varint,198,6980
varbit,198,1318
varint,199,e980
varbit,199,1718
varint,200,1980
varbit,200,1098
varint,201,9980
varbit,201,1498
varint,202,5980
varbit,202,1298
varint,203,d980
varbit,203,1698
varint,204,3980
varbit,204,1198
varint,205,b980
varbit,205,1598
varint,206,7980
varbit,206,1398
varint,207,f980
varbit,207,1798
varint,208,0d80
varbit,208,1058
varint,209,8d80
varbit,209,1458
varint,210,4d80
varbit,210,1258
varint,211,cd80
varbit,211,1658
varint,212,2d80
varbit,212,1158
varint,213,ad80
varbit,213,1558
varint,214,6d80
varbit,214,1358
varint,215,ed80
varbit,215,1758
varint,216,1d80
varbit,216,10d8
varint,217,9d80
varbit,217,14d8
varint,218,5d80
varbit,218,12d8
varint,219,dd80
varbit,219,16d8
varint,220,3d80
varbit,220,11d8
varint,221,bd80
varbit,221,15d8
varint,222,7d80
varbit,222,13d8
varint,223,fd80
varbit,223,17d8
varint,224,0b80
varbit,224,1038
varint,225,8b80
varbit,225,1438
varint,226,4b80
varbit,226,1238
varint,227,cb80
varbit,227,1638
varint,228,2b80
varbit,228,1138
varint,229,ab80
varbit,229,1538
varint,230,6b80
varbit,230,1338
varint,231,eb80
varbit,231,1738
varint,232,1b80
varbit,232,10b8
varint,233,9b80
varbit,233,14b8
varint,234,5b80
varbit,234,12b8
varint,235,db80
varbit,235,16b8
varint,236,3b80
varbit,236,11b8
varint,237,bb80
varbit,237,15b8
varint,238,7b80
varbit,238,13b8
varint,239,fb80
varbit,239,17b8
varint,240,0f80
varbit,240,1078
varint,241,8f80
varbit,241,1478
varint,242,4f80
varbit,242,1278
varint,243,cf80
varbit,243,1678
varint,244,2f80
varbit,244,1178
varint,245,af80
varbit,245,1578
varint,246,6f80
varbit,246,1378
varint,247,ef80
varbit,247,1778
varint,248,1f80
varbit,248,10f8
varint,249,9f80
varbit,249,14f8
varint,250,5f80
varbit,250,12f8
varint,251,df80
varbit,251,16f8
varint,252,3f80
varbit,252,11f8
varint,253,bf80
varbit,253,15f8
varint,254,7f80
varbit,254,13f8
varint,255,ff80
varbit,255,17f8
varint,256,0860
varbit,256,9004
varint,257,8860
varbit,257,9404
varint,258,4860
varbit,258,9204
varint,259,c860
varbit,259,9604
varint,260,2860
varbit,260,9104
varint,261,a860
varbit,261,9504
varint,262,6860
varbit,262,9304
varint,263,e860
varbit,263,9704
varint,264,1860
varbit,264,9084
varint,265,9860
varbit,265,9484
varint,266,5860
varbit,266,9284
varint,267,d860
varbit,267,9684
varint,268,3860
varbit,268,9184
varint,269,b860
varbit,269,9584
varint,270,7860
varbit,270,9384
varint,271,f860
varbit,271,9784
varint,272,0c60
varbit,272,9044
varint,273,8c60
varbit,273,9444
varint,274,4c60
varbit,274,9244
varint,275,cc60
varbit,275,9644
varint,276,2c60
varbit,276,9144
varint,277,ac60
varbit,277,9544
varint,278,6c60
varbit,278,9344
varint,279,ec60
varbit,279,9744
varint,280,1c60
varbit,280,90c4
varint,281,9c60
varbit,281,94c4
varint,282,5c60
varbit,282,92c4
varint,283,dc60
varbit,283,96c4
varint,284,3c60
varbit,284,91c4
varint,285,bc60
varbit,285,95c4
varint,286,7c60
varbit,286,93c4
varint,287,fc60
varbit,287,97c4
varint,288,0a60
varbit,288,9024
varint,289,8a60
varbit,289,9424
varint,290,4a60
varbit,290,9224
varint,291,ca60
varbit,291,9624
varint,292,2a60
varbit,292,9124
varint,293,aa60
varbit,293,9524
varint,294,6a60
varbit,294,9324
varint,295,ea60
varbit,295,9724
varint,296,1a60
varbit,296,90a4
varint,297,9a60
varbit,297,94a4
varint,298,5a60
varbit,298,92a4
varint,299,da60
varbit,299,96a4
varint,300,3a60
varbit,300,91a4
varint,301,ba60
varbit,301,95a4
varint,302,7a60
varbit,302,93a4
varint,303,fa60
varbit,303,97a4
varint,304,0e60
varbit,304,9064
varint,305,8e60
varbit,305,9464
varint,306,4e60
varbit,306,9264
varint,307,ce60
varbit,307,9664
varint,308,2e60
varbit,308,9164
varint,309,ae60
varbit,309,9564
varint,310,6e60
varbit,310,9364
varint,311,ee60
varbit,311,9764
varint,312,1e60
varbit,312,90e4
varint,313,9e60
varbit,313,94e4
varint,314,5e60
varbit,314,92e4
varint,315,de60
varbit,315,96e4
varint,316,3e60
varbit,316,91e4
varint,317,be60
varbit,317,95e4
varint,318,7e60
varbit,318,93e4
varint,319,fe60
varbit,319,97e4
varint,320,0960
varbit,320,9014
varint,321,8960
varbit,321,9414
varint,322,4960
varbit,322,9214
varint,323,c960
varbit,323,9614
varint,324,2960
varbit,324,9114
varint,325,a960
varbit,325,9514
varint,326,6960
varbit,326,9314
varint,327,e960
varbit,327,9714
varint,328,1960
varbit,328,9094
varint,329,9960
varbit,329,9494
varint,330,5960
varbit,330,9294
varint,331,d960
varbit,331,9694
varint,332,3960
varbit,332,9194
varint,333,b960
varbit,333,9594
varint,334,7960
varbit,334,9394
varint,335,f960
varbit,335,9794
varint,336,0d60
varbit,336,9054
varint,337,8d60
varbit,337,9454
varint,338,4d60
varbit,338,9254
varint,339,cd60
varbit,339,9654
varint,340,2d60
varbit,340,9154
varint,341,ad60
varbit,341,9554
varint,342,6d60
varbit,342,9354
varint,343,ed60
varbit,343,9754
varint,344,1d60
varbit,344,90d4
varint,345,9d60
varbit,345,94d4
varint,346,5d60
varbit,346,92d4
varint,347,dd60
varbit,347,96d4
varint,348,3d60
varbit,348,91d4
varint,349,bd60
varbit,349,95d4
varint,350,7d60
varbit,350,93d4
varint,351,fd60
varbit,351,97d4
varint,352,0b60
varbit,352,9034
varint,353,8b60
varbit,353,9434
varint,354,4b60
varbit,354,9234
varint,355,cb60
varbit,355,9634
varint,356,2b60
varbit,356,9134
varint,357,ab60
varbit,357,9534
varint,358,6b60
varbit,358,9334
varint,359,eb60
varbit,359,9734
varint,360,1b60
varbit,360,90b4
varint,361,9b60
varbit,361,94b4
varint,362,5b60
varbit,362,92b4
varint,363,db60
varbit,363,96b4
varint,364,3b60
varbit,364,91b4
varint,365,bb60
varbit,365,95b4
varint,366,7b60
varbit,366,93b4
varint,367,fb60
varbit,367,97b4
varint,368,0f60
varbit,368,9074
varint,369,8f60
varbit,369,9474
varint,370,4f60
varbit,370,9274
varint,371,cf60
varbit,371,9674
varint,372,2f60
varbit,372,9174
varint,373,af60
varbit,373,9574
varint,374,6f60
varbit,374,9374
varint,375,ef60
varbit,375,9774
varint,376,1f60
varbit,376,90f4
varint,377,9f60
varbit,377,94f4
varint,378,5f60
varbit,378,92f4
varint,379,df60
varbit,379,96f4
varint,380,3f60
varbit,380,91f4
varint,381,bf60
varbit,381,95f4
varint,382,7f60
varbit,382,93f4
varint,383,ff60
varbit,383,97f4
varint,384,08e0
varbit,384,900c
varint,385,88e0
varbit,385,940c
varint,386,48e0
varbit,386,920c
varint,387,c8e0
varbit,387,960c
varint,388,28e0
varbit,388,910c
varint,389,a8e0
varbit,389,950c
varint,390,68e0
varbit,390,930c
varint,391,e8e0
varbit,391,970c
varint,392,18e0
varbit,392,908c
varint,393,98e0
varbit,393,948c
varint,394,58e0
varbit,394,928c
varint,395,d8e0
varbit,395,968c
varint,396,38e0
varbit,396,918c
varint,397,b8e0
varbit,397,958c
varint,398,78e0
varbit,398,938c
varint,399,f8e0
varbit,399,978c
varint,400,0ce0
varbit,400,904c
varint,401,8ce0
varbit,401,944c
varint,402,4ce0
varbit,402,924c
varint,403,cce0
varbit,403,964c
varint,404,2ce0
varbit,404,914c
varint,405,ace0
varbit,405,954c
varint,406,6ce0
varbit,406,934c
varint,407,ece0
varbit,407,974c
varint,408,1ce0
varbit,408,90cc
varint,409,9ce0
varbit,409,94cc
varint,410,5ce0
varbit,410,92cc
varint,411,dce0
varbit,411,96cc
varint,412,3ce0
varbit,412,91cc
varint,413,bce0
varbit,413,95cc
varint,414,7ce0
varbit,414,93cc
varint,415,fce0
varbit,415,97cc
varint,416,0ae0
varbit,416,902c
varint,417,8ae0
varbit,417,942c
varint,418,4ae0
varbit,418,922c
varint,419,cae0
varbit,419,962c
varint,420,2ae0
varbit,420,912c
varint,421,aae0
varbit,421,952c
varint,422,6ae0
varbit,422,932c
varint,423,eae0
varbit,423,972c
varint,424,1ae0
varbit,424,90ac
varint,425,9ae0
varbit,425,94ac
varint,426,5ae0
varbit,426,92ac
varint,427,dae0
varbit,427,96ac
varint,428,3ae0
varbit,428,91ac
varint,429,bae0
varbit,429,95ac
varint,430,7ae0
varbit,430,93ac
varint,431,fae0
varbit,431,97ac
varint,432,0ee0
varbit,432,906c
varint,433,8ee0
varbit,433,946c
varint,434,4ee0
varbit,434,926c
varint,435,cee0
varbit,435,966c
varint,436,2ee0
varbit,436,916c
varint,437,aee0
varbit,437,956c
varint,438,6ee0
varbit,438,936c
varint,439,eee0
varbit,439,976c
varint,440,1ee0
varbit,440,90ec
varint,441,9ee0
varbit,441,94ec
varint,442,5ee0
varbit,442,92ec
varint,443,dee0
varbit,443,96ec
varint,444,3ee0
varbit,444,91ec
varint,445,bee0
varbit,445,95ec
varint,446,7ee0
varbit,446,93ec
varint,447,fee0
varbit,447,97ec
varint,448,09e0
varbit,448,901c
varint,449,89e0
varbit,449,941c
varint,450,49e0
varbit,450,921c
varint,451,c9e0
varbit,451,961c
varint,452,29e0
varbit,452,911c
varint,453,a9e0
varbit,453,951c
varint,454,69e0
varbit,454,931c
varint,455,e9e0
varbit,455,971c
varint,456,19e0
varbit,456,909c
varint,457,99e0
varbit,457,949c
varint,458,59e0
varbit,458,929c
varint,459,d9e0
varbit,459,969c
varint,460,39e0
varbit,460,919c
varint,461,b9e0
varbit,461,959c
varint,462,79e0
varbit,462,939c
varint,463,f9e0
varbit,463,979c
varint,464,0de0
varbit,464,905c
varint,465,8de0
varbit,465,945c
varint,466,4de0
varbit,466,925c
varint,467,cde0
varbit,467,965c
varint,468,2de0
varbit,468,915c
varint,469,ade0
varbit,469,955c
varint,470,6de0
varbit,470,935c
varint,471,ede0
varbit,471,975c
varint,472,1de0
varbit,472,90dc
varint,473,9de0
varbit,473,94dc
varint,474,5de0
varbit,474,92dc
varint,475,dde0
varbit,475,96dc
varint,476,3de0
varbit,476,91dc
varint,477,bde0
varbit,477,95dc
varint,478,7de0
varbit,478,93dc
varint,479,fde0
varbit,479,97dc
varint,480,0be0
varbit,480,903c
varint,481,8be0
varbit,481,943c
varint,482,4be0
varbit,482,923c
varint,483,cbe0
varbit,483,963c
varint,484,2be0
varbit,484,913c
varint,485,abe0
varbit,485,953c
varint,486,6be0
varbit,486,933c
varint,487,ebe0
varbit,487,973c
varint,488,1be0
varbit,488,90bc
varint,489,9be0
varbit,489,94bc
varint,490,5be0
varbit,490,92bc
varint,491,dbe0
varbit,491,96bc
varint,492,3be0
varbit,492,91bc
varint,493,bbe0
varbit,493,95bc
varint,494,7be0
varbit,494,93bc
varint,495,fbe0
varbit,495,97bc
varint,496,0fe0
varbit,496,907c
varint,497,8fe0
varbit,497,947c
varint,498,4fe0
varbit,498,927c
varint,499,cfe0
varbit,499,967c
varint,500,2fe0
varbit,500,917c
varint,501,afe0
varbit,501,957c
varint,502,6fe0
varbit,502,937c
varint,503,efe0
varbit,503,977c
varint,504,1fe0
varbit,504,90fc
varint,505,9fe0
varbit,505,94fc
varint,506,5fe0
varbit,506,92fc
varint,507,dfe0
varbit,507,96fc
varint,508,3fe0
varbit,508,91fc
varint,509,bfe0
varbit,509,95fc
varint,510,7fe0
varbit,510,93fc
varint,511,ffe0
varbit,511,97fc
varint,512,0850
varbit,512,5002
varint,513,8850
varbit,513,5402
varint,514,4850
varbit,514,5202
varint,515,c850
varbit,515,5602
varint,516,2850
varbit,516,5102
varint,517,a850
varbit,517,5502
varint,518,6850
varbit,518,5302
varint,519,e850
varbit,519,5702
varint,520,1850
varbit,520,5082
varint,521,9850
varbit,521,5482
varint,522,5850
varbit,522,5282
varint,523,d850
varbit,523,5682
varint,524,3850
varbit,524,5182
varint,525,b850
varbit,525,5582
varint,526,7850
varbit,526,5382
varint,527,f850
varbit,527,5782
varint,528,0c50
varbit,528,5042
varint,529,8c50
varbit,529,5442
varint,530,4c50
varbit,530,5242
varint,531,cc50
varbit,531,5642
varint,532,2c50
varbit,532,5142
varint,533,ac50
varbit,533,5542
varint,534,6c50
varbit,534,5342
varint,535,ec50
varbit,535,5742
varint,536,1c50
varbit,536,50c2
varint,537,9c50
varbit,537,54c2
varint,538,5c50
varbit,538,52c2
varint,539,dc50
varbit,539,56c2
varint,540,3c50
varbit,540,51c2
varint,541,bc50
varbit,541,55c2
varint,542,7c50
varbit,542,53c2
varint,543,fc50
varbit,543,57c2
varint,544,0a50
varbit,544,5022
varint,545,8a50
varbit,545,5422
varint,546,4a50
varbit,546,5222
varint,547,ca50
varbit,547,5622
varint,548,2a50
varbit,548,5122
varint,549,aa50
varbit,549,5522
varint,550,6a50
varbit,550,5322
varint,551,ea50
varbit,551,5722
varint,552,1a50
varbit,552,50a2
varint,553,9a50
varbit,553,54a2
varint,554,5a50
varbit,554,52a2
varint,555,da50
varbit,555,56a2
varint,556,3a50
varbit,556,51a2
varint,557,ba50
varbit,557,55a2
varint,558,7a50
varbit,558,53a2
varint,559,fa50
varbit,559,57a2
varint,560,0e50
varbit,560,5062
varint,561,8e50
varbit,561,5462
varint,562,4e50
varbit,562,5262
varint,563,ce50
varbit,563,5662
varint,564,2e50
varbit,564,5162
varint,565,ae50
varbit,565,5562
varint,566,6e50
varbit,566,5362
varint,567,ee50
varbit,567,5762
varint,568,1e50
varbit,568,50e2
varint,569,9e50
varbit,569,54e2
varint,570,5e50
varbit,570,52e2
varint,571,de50
varbit,571,56e2
varint,572,3e50
varbit,572,51e2
varint,573,be50
varbit,573,55e2
varint,574,7e50
varbit,574,53e2
varint,575,fe50
varbit,575,57e2
varint,576,0950
varbit,576,5012
varint,577,8950
varbit,577,5412
varint,578,4950
varbit,578,5212
varint,579,c950
varbit,579,5612
varint,580,2950
varbit,580,5112
varint,581,a950
varbit,581,5512
varint,582,6950
varbit,582,5312
varint,583,e950
varbit,583,5712
varint,584,1950
varbit,584,5092
varint,585,9950
varbit,585,5492
varint,586,5950
varbit,586,5292
varint,587,d950
varbit,587,5692
varint,588,3950
varbit,588,5192
varint,589,b950
varbit,589,5592
varint,590,7950
varbit,590,5392
varint,591,f950
varbit,591,5792
varint,592,0d50
varbit,592,5052
varint,593,8d50
varbit,593,5452
varint,594,4d50
varbit,594,5252
varint,595,cd50
varbit,595,5652
varint,596,2d50
varbit,596,5152
varint,597,ad50
varbit,597,5552
varint,598,6d50
varbit,598,5352
varint,599,ed50
varbit,599,5752
varint,600,1d50
varbit,600,50d2
varint,601,9d50
varbit,601,54d2
varint,602,5d50
varbit,602,52d2
varint,603,dd50
varbit,603,56d2
varint,604,3d50
varbit,604,51d2
varint,605,bd50
varbit,605,55d2
varint,606,7d50
varbit,606,53d2
varint,607,fd50
varbit,607,57d2
varint,608,0b50
varbit,608,5032
varint,609,8b50
varbit,609,5432
varint,610,4b50
varbit,610,5232
varint,611,cb50
varbit,611,5632
varint,612,2b50
varbit,612,5132
varint,613,ab50
varbit,613,5532
varint,614,6b50
varbit,614,5332
varint,615,eb50
varbit,615,5732
varint,616,1b50
varbit,616,50b2
varint,617,9b50
varbit,617,54b2
varint,618,5b50
varbit,618,52b2
varint,619,db50
varbit,619,56b2
varint,620,3b50
varbit,620,51b2
varint,621,bb50
varbit,621,55b2
varint,622,7b50
varbit,622,53b2
varint,623,fb50
varbit,623,57b2
varint,624,0f50
varbit,624,5072
varint,625,8f50
varbit,625,5472
varint,626,4f50
varbit,626,5272
varint,627,cf50
varbit,627,5672
varint,628,2f50
varbit,628,5172
varint,629,af50
varbit,629,5572
varint,630,6f50
varbit,630,5372
varint,631,ef50
varbit,631,5772
varint,632,1f50
varbit,632,50f2
varint,633,9f50
varbit,633,54f2
varint,634,5f50
varbit,634,52f2
varint,635,df50
varbit,635,56f2
varint,636,3f50
varbit,636,51f2
varint,637,bf50
varbit,637,55f2
varint,638,7f50
varbit,638,53f2
varint,639,ff50
varbit,639,57f2
varint,640,08d0
varbit,640,500a
varint,641,88d0
varbit,641,540a
varint,642,48d0
varbit,642,520a
varint,643,c8d0
varbit,643,560a
varint,644,28d0
varbit,644,510a
varint,645,a8d0
varbit,645,550a
varint,646,68d0
varbit,646,530a
varint,647,e8d0
varbit,647,570a
varint,648,18d0
varbit,648,508a
varint,649,98d0
varbit,649,548a
varint,650,58d0
varbit,650,528a
varint,651,d8d0
varbit,651,568a
varint,652,38d0
varbit,652,518a
varint,653,b8d0
varbit,653,558a
varint,654,78d0
varbit,654,538a
varint,655,f8d0
varbit,655,578a
varint,656,0cd0
varbit,656,504a
varint,657,8cd0
varbit,657,544a
varint,658,4cd0
varbit,658,524a
varint,659,ccd0
varbit,659,564a
varint,660,2cd0
varbit,660,514a
varint,661,acd0
varbit,661,554a
varint,662,6cd0
varbit,662,534a
varint,663,ecd0
varbit,663,574a
varint,664,1cd0
varbit,664,50ca
varint,665,9cd0
varbit,665,54ca
varint,666,5cd0
varbit,666,52ca
varint,667,dcd0
varbit,667,56ca
varint,668,3cd0
varbit,668,51ca
varint,669,bcd0
varbit,669,55ca
varint,670,7cd0
varbit,670,53ca
varint,671,fcd0
varbit,671,57ca
varint,672,0ad0
varbit,672,502a
varint,673,8ad0
varbit,673,542a
varint,674,4ad0
varbit,674,522a
varint,675,cad0
varbit,675,562a
varint,676,2ad0
varbit,676,512a
varint,677,aad0
varbit,677,552a
varint,678,6ad0
varbit,678,532a
varint,679,ead0
varbit,679,572a
varint,680,1ad0
varbit,680,50aa
varint,681,9ad0
varbit,681,54aa
varint,682,5ad0
varbit,682,52aa
varint,683,dad0
varbit,683,56aa
varint,684,3ad0
varbit,684,51aa
varint,685,bad0
varbit,685,55aa
varint,686,7ad0
varbit,686,53aa
varint,687,fad0
varbit,687,57aa
varint,688,0ed0
varbit,688,506a
varint,689,8ed0
varbit,689,546a
varint,690,4ed0
varbit,690,526a
varint,691,ced0
varbit,691,566a
varint,692,2ed0
varbit,692,516a
varint,693,aed0
varbit,693,556a
varint,694,6ed0
varbit,694,536a
varint,695,eed0
varbit,695,576a
varint,696,1ed0
varbit,696,50ea
varint,697,9ed0
varbit,697,54ea
varint,698,5ed0
varbit,698,52ea
varint,699,ded0
varbit,699,56ea
varint,700,3ed0
varbit,700,51ea
varint,701,bed0
varbit,701,55ea
varint,702,7ed0
varbit,702,53ea
varint,703,fed0
varbit,703,57ea
varint,704,09d0
varbit,704,501a
varint,705,89d0
varbit,705,541a
varint,706,49d0
varbit,706,521a
varint,707,c9d0
varbit,707,561a
varint,708,29d0
varbit,708,511a
varint,709,a9d0
varbit,709,551a
varint,710,69d0
varbit,710,531a
varint,711,e9d0
varbit,711,571a
varint,712,19d0
varbit,712,509a
varint,713,99d0
varbit,713,549a
varint,714,59d0
varbit,714,529a
varint,715,d9d0
varbit,715,569a
varint,716,39d0
varbit,716,519a
varint,717,b9d0
varbit,717,559a
varint,718,79d0
varbit,718,539a
varint,719,f9d0
varbit,719,579a
varint,720,0dd0
varbit,720,505a
varint,721,8dd0
varbit,721,545a
varint,722,4dd0
varbit,722,525a
varint,723,cdd0
varbit,723,565a
varint,724,2dd0
varbit,724,515a
varint,725,add0
varbit,725,555a
varint,726,6dd0
varbit,726,535a
varint,727,edd0
varbit,727,575a
varint,728,1dd0
varbit,728,50da
varint,729,9dd0
varbit,729,54da
varint,730,5dd0
varbit,730,52da
varint,731,ddd0
varbit,731,56da
varint,732,3dd0
varbit,732,51da
varint,733,bdd0
varbit,733,55da
varint,734,7dd0
varbit,734,53da
varint,735,fdd0
varbit,735,57da
varint,736,0bd0
varbit,736,503a
varint,737,8bd0
varbit,737,543a
varint,738,4bd0
varbit,738,523a
varint,739,cbd0
varbit,739,563a
varint,740,2bd0
varbit,740,513a
varint,741,abd0
varbit,741,553a
varint,742,6bd0
varbit,742,533a
varint,743,ebd0
varbit,743,573a
varint,744,1bd0
varbit,744,50ba
varint,745,9bd0
varbit,745,54ba
varint,746,5bd0
varbit,746,52ba
varint,747,dbd0
varbit,747,56ba
varint,748,3bd0
varbit,748,51ba
varint,749,bbd0
varbit,749,55ba
varint,750,7bd0
varbit,750,53ba
varint,751,fbd0
varbit,751,57ba
varint,752,0fd0
varbit,752,507a
varint,753,8fd0
varbit,753,547a
varint,754,4fd0
varbit,754,527a
varint,755,cfd0
varbit,755,567a
varint,756,2fd0
varbit,756,517a
varint,757,afd0
varbit,757,557a
varint,758,6fd0
varbit,758,537a
varint,759,efd0
varbit,759,577a
varint,760,1fd0
varbit,760,50fa
varint,761,9fd0
varbit,761,54fa
varint,762,5fd0
varbit,762,52fa
varint,763,dfd0
varbit,763,56fa
varint,764,3fd0
varbit,764,51fa
varint,765,bfd0
varbit,765,55fa
varint,766,7fd0
varbit,766,53fa
varint,767,ffd0
varbit,767,57fa
varint,768,0870
varbit,768,5006
varint,769,8870
varbit,769,5406
varint,770,4870
varbit,770,5206
varint,771,c870
varbit,771,5606
varint,772,2870
varbit,772,5106
varint,773,a870
varbit,773,5506
varint,774,6870
varbit,774,5306
varint,775,e870
varbit,775,5706
varint,776,1870
varbit,776,5086
varint,777,9870
varbit,777,5486
varint,778,5870
varbit,778,5286
varint,779,d870
varbit,779,5686
varint,780,3870
varbit,780,5186
varint,781,b870
varbit,781,5586
varint,782,7870
varbit,782,5386
varint,783,f870
varbit,783,5786
varint,784,0c70
varbit,784,5046
varint,785,8c70
varbit,785,5446
varint,786,4c70
varbit,786,5246
varint,787,cc70
varbit,787,5646
varint,788,2c70
varbit,788,5146
varint,789,ac70
varbit,789,5546
varint,790,6c70
varbit,790,5346
varint,791,ec70
varbit,791,5746
varint,792,1c70
varbit,792,50c6
varint,793,9c70
varbit,793,54c6
varint,794,5c70
varbit,794,52c6
varint,795,dc70
varbit,795,56c6
varint,796,3c70
varbit,796,51c6
varint,797,bc70
varbit,797,55c6
varint,798,7c70
varbit,798,53c6
varint,799,fc70
varbit,799,57c6
varint,800,0a70
varbit,800,5026
varint,801,8a70
varbit,801,5426
varint,802,4a70
varbit,802,5226
varint,803,ca70
varbit,803,5626
varint,804,2a70
varbit,804,5126
varint,805,aa70
varbit,805,5526
varint,806,6a70
varbit,806,5326
varint,807,ea70
varbit,807,5726
varint,808,1a70
varbit,808,50a6
varint,809,9a70
varbit,809,54a6
varint,810,5a70
varbit,810,52a6
varint,811,da70
varbit,811,56a6
varint,812,3a70
varbit,812,51a6
varint,813,ba70
varbit,813,55a6
varint,814,7a70
varbit,814,53a6
varint,815,fa70
varbit,815,57a6
varint,816,0e70
varbit,816,5066
varint,817,8e70
varbit,817,5466
varint,818,4e70
varbit,818,5266
varint,819,ce70
varbit,819,5666
varint,820,2e70
varbit,820,5166
varint,821,ae70
varbit,821,5566
varint,822,6e70
varbit,822,5366
varint,823,ee70
varbit,823,5766
varint,824,1e70
varbit,824,50e6
varint,825,9e70
varbit,825,54e6
varint,826,5e70
varbit,826,52e6
varint,827,de70
varbit,827,56e6
varint,828,3e70
varbit,828,51e6
varint,829,be70
varbit,829,55e6
varint,830,7e70
varbit,830,53e6
varint,831,fe70
varbit,831,57e6
varint,832,0970
varbit,832,5016
varint,833,8970
varbit,833,5416
varint,834,4970
varbit,834,5216
varint,835,c970
varbit,835,5616
varint,836,2970
varbit,836,5116
varint,837,a970
varbit,837,5516
varint,838,6970
varbit,838,5316
varint,839,e970
varbit,839,5716
varint,840,1970
varbit,840,5096
varint,841,9970
varbit,841,5496
varint,842,5970
varbit,842,5296
varint,843,d970
varbit,843,5696
varint,844,3970
varbit,844,5196
varint,845,b970
varbit,845,5596
varint,846,7970
varbit,846,5396
varint,847,f970
varbit,847,5796
varint,848,0d70
varbit,848,5056
varint,849,8d70
varbit,849,5456
varint,850,4d70
varbit,850,5256
varint,851,cd70
varbit,851,5656
varint,852,2d70
varbit,852,5156
varint,853,ad70
varbit,853,5556
varint,854,6d70
varbit,854,5356
varint,855,ed70
varbit,855,5756
varint,856,1d70
varbit,856,50d6
varint,857,9d70
varbit,857,54d6
varint,858,5d70
varbit,858,52d6
varint,859,dd70
varbit,859,56d6
varint,860,3d70
varbit,860,51d6
varint,861,bd70
varbit,861,55d6
varint,862,7d70
varbit,862,53d6
varint,863,fd70
varbit,863,57d6
varint,864,0b70
varbit,864,5036
varint,865,8b70
varbit,865,5436
varint,866,4b70
varbit,866,5236
varint,867,cb70
varbit,867,5636
varint,868,2b70
varbit,868,5136
varint,869,ab70
varbit,869,5536
varint,870,6b70
varbit,870,5336
varint,871,eb70
varbit,871,5736
varint,872,1b70
varbit,872,50b6
varint,873,9b70
varbit,873,54b6
varint,874,5b70
varbit,874,52b6
varint,875,db70
varbit,875,56b6
varint,876,3b70
varbit,876,51b6
varint,877,bb70
varbit,877,55b6
varint,878,7b70
varbit,878,53b6
varint,879,fb70
varbit,879,57b6
varint,880,0f70
varbit,880,5076
varint,881,8f70
varbit,881,5476
varint,882,4f70
varbit,882,5276
varint,883,cf70
varbit,883,5676
varint,884,2f70
varbit,884,5176
varint,885,af70
varbit,885,5576
varint,886,6f70
varbit,886,5376
varint,887,ef70
varbit,887,5776
varint,888,1f70
varbit,888,50f6
varint,889,9f70
varbit,889,54f6
varint,890,5f70
varbit,890,52f6
varint,891,df70
varbit,891,56f6
varint,892,3f70
varbit,892,51f6
varint,893,bf70
varbit,893,55f6
varint,894,7f70
varbit,894,53f6
varint,895,ff70
varbit,895,57f6
varint,896,08f0
varbit,896,500e
varint,897,88f0
varbit,897,540e
varint,898,48f0
varbit,898,520e
varint,899,c8f0
varbit,899,560e
varint,900,28f0
varbit,900,510e
varint,901,a8f0
varbit,901,550e
varint,902,68f0
varbit,902,530e
varint,903,e8f0
varbit,903,570e
varint,904,18f0
varbit,904,508e
varint,905,98f0
varbit,905,548e
varint,906,58f0
varbit,906,528e
varint,907,d8f0
varbit,907,568e
varint,908,38f0
varbit,908,518e
varint,909,b8f0
varbit,909,558e
varint,910,78f0
varbit,910,538e
varint,911,f8f0
varbit,911,578e
varint,912,0cf0
varbit,912,504e
varint,913,8cf0
varbit,913,544e
varint,914,4cf0
varbit,914,524e
varint,915,ccf0
varbit,915,564e
varint,916,2cf0
varbit,916,514e
varint,917,acf0
varbit,917,554e
varint,918,6cf0
varbit,918,534e
varint,919,ecf0
varbit,919,574e
varint,920,1cf0
varbit,920,50ce
varint,921,9cf0
varbit,921,54ce
varint,922,5cf0
varbit,922,52ce
varint,923,dcf0
varbit,923,56ce
varint,924,3cf0
varbit,924,51ce
varint,925,bcf0
varbit,925,55ce
varint,926,7cf0
varbit,926,53ce
varint,927,fcf0
varbit,927,57ce
varint,928,0af0
varbit,928,502e
varint,929,8af0
varbit,929,542e
varint,930,4af0
varbit,930,522e
varint,931,caf0
varbit,931,562e
varint,932,2af0
varbit,932,512e
varint,933,aaf0
varbit,933,552e
varint,934,6af0
varbit,934,532e
varint,935,eaf0
varbit,935,572e
varint,936,1af0
varbit,936,50ae
varint,937,9af0
varbit,937,54ae
varint,938,5af0
varbit,938,52ae
varint,939,daf0
varbit,939,56ae
varint,940,3af0
varbit,940,51ae
varint,941,baf0
varbit,941,55ae
varint,942,7af0
varbit,942,53ae
varint,943,faf0
varbit,943,57ae
varint,944,0ef0
varbit,944,506e
varint,945,8ef0
varbit,945,546e
varint,946,4ef0
varbit,946,526e
varint,947,cef0
varbit,947,566e
varint,948,2ef0
varbit,948,516e
varint,949,aef0
varbit,949,556e
varint,950,6ef0
varbit,950,536e
varint,951,eef0
varbit,951,576e
varint,952,1ef0
varbit,952,50ee
varint,953,9ef0
varbit,953,54ee
varint,954,5ef0
varbit,954,52ee
varint,955,def0
varbit,955,56ee
varint,956,3ef0
varbit,956,51ee
varint,957,bef0
varbit,957,55ee
varint,958,7ef0
varbit,958,53ee
varint,959,fef0
varbit,959,57ee
varint,960,09f0
varbit,960,501e
varint,961,89f0
varbit,961,541e
varint,962,49f0
varbit,962,521e
varint,963,c9f0
varbit,963,561e
varint,964,29f0
varbit,964,511e
varint,965,a9f0
varbit,965,551e
varint,966,69f0
varbit,966,531e
varint,967,e9f0
varbit,967,571e
varint,968,19f0
varbit,968,509e
varint,969,99f0
varbit,969,549e
varint,970,59f0
varbit,970,529e
varint,971,d9f0
varbit,971,569e
varint,972,39f0
varbit,972,519e
varint,973,b9f0
varbit,973,559e
varint,974,79f0
varbit,974,539e
varint,975,f9f0
varbit,975,579e
varint,976,0df0
varbit,976,505e
varint,977,8df0
varbit,977,545e
varint,978,4df0
varbit,978,525e
varint,979,cdf0
varbit,979,565e
varint,980,2df0
varbit,980,515e
varint,981,adf0
varbit,981,555e
varint,982,6df0
varbit,982,535e
varint,983,edf0
varbit,983,575e
varint,984,1df0
varbit,984,50de
varint,985,9df0
varbit,985,54de
varint,986,5df0
varbit,986,52de
varint,987,ddf0
varbit,987,56de
varint,988,3df0
varbit,988,51de
varint,989,bdf0
varbit,989,55de
varint,990,7df0
varbit,990,53de
varint,991,fdf0
varbit,991,57de
varint,992,0bf0
varbit,992,503e
varint,993,8bf0
varbit,993,543e
varint,994,4bf0
varbit,994,523e
varint,995,cbf0
varbit,995,563e
varint,996,2bf0
varbit,996,513e
varint,997,abf0
varbit,997,553e
varint,998,6bf0
varbit,998,533e
varint,999,ebf0
varbit,999,573e
`;

const goData: { type: string; value: number; hex: string }[] = [];
goOutput
	.trim()
	.split('\n')
	.forEach((line) => {
		const [type, value, hex] = line.split(',');
		goData.push({ type, value: parseInt(value, 10), hex });
	});

// Mock Bitstream for testing write functions
class MockBitstream extends Bitstream {
	public writtenBits: number[] = [];

	writeBit(bit: number) {
		this.writtenBits.push(bit);
		super.writeBit(bit);
	}

	write(value: number, n: number) {
		for (let i = 0; i < n; i++) {
			this.writtenBits.push((value >> (n - 1 - i)) & 1);
		}
		super.write(value, n);
	}
}

// Import the functions to test
import { writeVarint, writeVarbit } from './encoder';

describe('Varint and Varbit Encoding Comparison with Go', () => {
	goData
		.filter((d) => d.type === 'varint')
		.forEach((data) => {
			it(`should encode varint ${data.value} correctly`, () => {
				const stream = new MockBitstream(new Uint8Array(10));
				writeVarint(stream, data.value);
				const encodedBytes = stream.bytes.slice(0, Math.ceil(stream.bit_pos / 8));
				const encodedHex = Array.from(encodedBytes)
					.map((b) => b.toString(16).padStart(2, '0'))
					.join('');
				expect(encodedHex).toBe(data.hex);
			});
		});

	goData
		.filter((d) => d.type === 'varbit')
		.forEach((data) => {
			it(`should encode varbit ${data.value} correctly`, () => {
				const stream = new MockBitstream(new Uint8Array(10));
				writeVarbit(stream, data.value);
				const encodedBytes = stream.bytes.slice(0, Math.ceil(stream.bit_pos / 8));
				const encodedHex = Array.from(encodedBytes)
					.map((b) => b.toString(16).padStart(2, '0'))
					.join('');
				expect(encodedHex).toBe(data.hex);
			});
		});
});
